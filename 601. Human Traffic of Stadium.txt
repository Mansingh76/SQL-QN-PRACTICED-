601. Human Traffic of Stadium


SELECT id,
       visit_date,
       people
FROM (
    SELECT id,
           visit_date,
           people,
           LEAD(people, 1) OVER (ORDER BY visit_date) AS next_people,
           LEAD(people, 2) OVER (ORDER BY visit_date) AS next2_people,
           LAG(people, 1) OVER (ORDER BY visit_date) AS prev_people,
           LAG(people, 2) OVER (ORDER BY visit_date) AS prev2_people
    FROM Stadium
) t
WHERE 
      (people >= 100 AND next_people >= 100 AND next2_people >= 100)
   OR (people >= 100 AND next_people >= 100 AND prev_people >= 100)
   OR (people >= 100 AND prev_people >= 100 AND prev2_people >= 100);
